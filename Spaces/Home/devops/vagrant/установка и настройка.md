С Vagrant можно создать идеальную среду разработки. Это обеспечивает автоматизацию и идеальный рабочий процесс, и в то же время позволяет сократить время, затрачиваемое на настройку. Опираясь на наш практический опыт, можем заверить вас, что Vagrant кроме уже упомянутых преимуществ еще и повышает уровень производства и разработки.

## Практическое применение Vagrant

Чтобы достичь определенного уровня гибкости и более высокой производительности, Vagrant создает идеальную рабочую среду. Эта среда воспроизводима, проста в настройке и достаточно портативна. Таким образом, эта команда может получить доступ к единому согласованному процессу с использованием стандартных отраслевых технологий.

Vagrant функционирует благодаря таким гигантам, как KVM, Docker, VirtualBox, VMware и другим провайдерам. С помощью Puppet, Chef или сценариев оболочки виртуальную машину можно настроить и автоматически установить.

Бродячие варианты использования:

- Изоляция сред разработки.
- IaC-тестирование.
- Тестирование распределенных систем.
- Разработка веб-приложений.
- Непрерывное развертывание и непрерывная интеграция.
- Совместная работа команд.
- Облачное тестирование и разработка.

В этой статье мы попытаемся поделиться своими практическими знаниями в этой области с подробными инструкциями по использованию Vagrant с KVM и VirtualBox. Это два основных поставщика Vagrant. Просмотрев пару инструкций, вы легко определите, какой костюм подойдет именно вам.

## Использование Vagrant в сочетании с VirtualBox в Debian 12

Прежде чем обсуждать реальный процесс установки Debian 12, давайте сначала получим некоторую теоретическую информацию о VirtualBox. Начнем с того, что это бесплатный гипервизор с открытым исходным кодом, который помогает запускать виртуальную машину (виртуальную машину) на хост-машине, фактически не влияя на операционную систему хоста. ОС после установки VirtualBox называется «Хост-операционная система». ОС, работающая под виртуальной машиной VirtualBox, называется «Гость».

Основное преимущество VirtualBox — это превосходство технических возможностей любой машины. Можно одновременно запускать несколько ОС на разных виртуальных машинах. Например, пользователи могут попробовать одновременно запустить любую систему Linux и Windows на MacBook без необходимости подвергать риску конфигурацию системы и приложения.

С помощью этого инструмента можно управлять как можно большим количеством виртуальных машин в зависимости от дисков и объема памяти. Для личного использования можно использовать бесплатную версию, но коммерческим клиентам рекомендуется получить лицензию для коммерческого использования. Цена может меняться в зависимости от количества пользователей и срока действия лицензии.

Теперь давайте продолжим более практические процессы. Чтобы установить Vagrant на Debian 12 с VirtualBox, просто выполните пару простых шагов.

### 1. Установка VirtualBox

Перед установкой Vagrant необходимо установить провайдер, в данном случае VirtualBox. После того, как вы выполнили этот шаг, вы можете приступить к следующему.

### 2. Настройка Vagrant

Vagrant установка начинается со следующей команды:

```
sudo apt -y install apt-transport-https ca-certificates curl software-properties-common
```

Как только это будет сделано, вы можете импортировать ключи GPG, набрав следующее:

```
wget -O- https://apt.releases.hashicorp.com/gpg | gpg --dearmor | sudo tee /usr/share/keyrings/hashicorp-archive-keyring.gpg
```

На данный момент официальный репозиторий APT находится на вашем компьютере, и до фактической установки Vagrant остается еще один шаг.

```
echo "deb 
[signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] 
https://apt.releases.hashicorp.com $(lsb_release -cs) main" | sudo tee 
/etc/apt/sources.list.d/hashicorp.list 
```

Установка Vagrant выполняется простой командой:

```
sudo apt update  
sudo apt install vagrant
```

Последнее, что вам нужно сделать, это проверить версию:

```
vagrant --version 
```

### 3. Реализация Vagrant

На этапе реализации мы решили поделиться парочкой команд, с помощью которых можно получить идеальную среду разработки. Для начала вам нужно будет создать файл, в котором будет находиться файл Vagrant.

```
mkdir ~/vagrant-project
```

Следующим шагом является выбор ящика, который будет использоваться в вашей системе для создания нового файла Vagrant. Чтобы получить эту коробку, вам нужно посетить официальный сайт и получить ее. Здесь мы покажем, как выглядит этот процесс с ubuntu/jammy64.

Для создания файла используйте следующую команду:

```
cd ~/vagrant-project  
vagrant init ubuntu/jammy64 
```

Как только все будет завершено, вы увидите уведомление о том, что файл был помещен в каталог и где можно получить дополнительную информацию об использовании Vagrant.

После создания файла воспользуйтесь любым текстовым редактором для внесения некоторых изменений в систему Debian.

```
sudo vim Vagrantfile
```

Для создания сетапа используйте следующее:

```
vagrant up
```

### Доступ к виртуальным машинам

Доступ и подключение к работающим виртуальным машинам осуществляется через SSH. Начните с такой команды:
```
vagrant ssh
```

Для отображения статуса виртуальных машин вам понадобится:

```
vagrant status
```

Чтобы показать состояние всех виртуальных сред, используйте:

```
vagrant global-status
```

Для выключения вам понадобится следующая команда:

```
vagrant halt 
```

Для спящего режима виртуальных машин используйте:

```
vagrant suspend
```

Восстановление виртуальных машин в исходное состояние выглядит так:

```
vagrant destroy
```

## Использование Vagrant с KVM

Теперь вы поняли весь процесс использования Vagrant с VirtualBox, давайте поговорим еще об одном возможном сценарии.

Как уже понятно, Vagrant не является автономным продуктом, он используется в сочетании с несколькими другими поставщиками, такими как Docker, VirtualBox (уже обсуждался), KVM и VMWare. VirtualBox считается провайдером по умолчанию, поэтому давайте обсудим еще один замечательный вариант — KVM.

Эта технология с открытым исходным кодом специально разработана для пользователей Linux. Благодаря этой технологии виртуализации можно запускать несколько изолированных сред. KVM является частью кода Linux, а это означает, что пользователи будут получать новые улучшения, функции и исправления без необходимости дополнительного проектирования.

Поскольку KVM является частью ядра Linux, такие компоненты, как планировщик процессов, диспетчер памяти, драйвер устройства, сетевой стек и многое другое, уже присутствуют. Каждая виртуальная машина реализуется как стандартный процесс с выделенным оборудованием, с использованием стандартного планировщика, памяти, процессоров и дисков.

Основными преимуществами этого инструмента являются более высокая производительность, масштабируемость, безопасность и, конечно же, экономическая эффективность. Теперь, когда у вас есть базовое понимание, давайте обсудим сам процесс установки KVM. Это относительно простой процесс, который не потребует от пользователей много времени.

### 1. Настройка KVM в Debian 12

Начните с установки KVM на свой компьютер. Затем добавьте пользователя с помощью следующей команды:

```
sudo usermod -a -G libvirt <realusername>
```

Когда поставщик установлен, вы можете продолжить следующий шаг.

### 2. Установка плагина vagrant-libvirt

Плагин vagrant-libvirt следует установить перед использованием KVM. Этот плагин необходим для подготовки машины и управления ею с помощью Vibvirt.

Чтобы начать процесс, вам сначала понадобятся зависимости:

```
sudo apt install build-essential
```

Для фактической установки плагина необходима следующая команда:

```
vagrant plugin install vagrant-libvirt
```

Также важно наличие плагина agrant-mutate, который отвечает за смену ящиков и работу с разными провайдерами. Итак, следует использовать следующую команду:

```
vagrant plugin install vagrant-mutate
```

### 3. Использование Vagrant через поставщика KVM Libvirt

Во-первых, важно определить, поддерживает ли выбранный вами ящик Vagrant поставщика libvirt. Это можно сделать в облачном репозитории. Просто выберите «libvirt», чтобы понять, какие коробки поддерживаются.

Здесь, в этой части, мы будем использовать коробку CentOS 9.

Начните с настройки среды с помощью следующих команд:

```
mkdir my_vagrant  
cd my_vagrant  
vagrant init generic/centos9s 
```

Затем запустите машину с помощью следующей команды:

```
vagrant up --provider=libvirt
```

С помощью этой конкретной команды виртуальная машина работает с libvirt KVM. Итак, KVM служит опцией по умолчанию. Вывод этих команд обычно включает в себя различные характеристики по умолчанию, такие как процессоры, имя, функция, тип домена, описание, память, базовый блок и другие.

Для неограниченного использования этого конкретного поставщика по умолчанию вы можете ввести следующую команду:

```
export VAGRANT_DEFAULT_PROVIDER=libvirt
```

Для подтверждения используйте такую ​​программу как Вирт-менеджер, это идеальная программа управления с графическим интерфейсом.

Теперь перейдем к паре дополнительных полезных команд:

- Для перезагрузки виртуальной машины используйте:

```
vagrant reload
```

- Для полей списков используйте:

```
vagrant box list
```

- Чтобы получить информацию о том, устарел ли ящик, введите:

```
cd my_vagrants/  
vagrant box outdated
```

- Для обновления ящиков используйте:

```
vagrant box update
```

- Для загрузки коробок используйте следующее:

```
vagrant box add <box>
```

- Чтобы проверить размер коробок, используйте:

```
ls ~/.vagrant.d/boxes
```

Это все основные команды, которыми должен обладать пользователь для успешной установки и управления системой. Остальные вещи обычно не являются обязательными.

## Последние мысли

Здесь, в этой статье, мы упомянули наиболее важные шаги, которые пользователи должны выполнить, чтобы использовать Vagrant в KVM и VirtualBox. Надеемся, что наши практические знания в этой области помогут вам немного лучше понять процесс, и вы попытаетесь повторить инструкции этого руководства. Сочетание KVM/VirtualBox и Vagrant создает идеальную среду для тестирования и разработки. С помощью этих технологий можно повысить эффективность и обеспечить плавную интеграцию разработки программного обеспечения.